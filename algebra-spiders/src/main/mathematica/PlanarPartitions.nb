(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6155,        179]
NotebookOptionsPosition[      5789,        161]
NotebookOutlinePosition[      6146,        177]
CellTagsIndexPosition[      6103,        174]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"PlanarPartitions", "[", 
   RowBox[{"size_Integer", ",", 
    RowBox[{"allowSingletons", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "False"}]}], "]"}], ":=", 
  RowBox[{"PlanarPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "size", "]"}], ",", "allowSingletons"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlanarPartitions", "[", 
   RowBox[{"set_", ",", 
    RowBox[{"allowSingletons", ":", 
     RowBox[{"(", 
      RowBox[{"True", "|", "False"}], ")"}], ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "min", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"min", "=", 
      RowBox[{"If", "[", 
       RowBox[{"allowSingletons", ",", "1", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "nextPart", "}"}], ",", 
          RowBox[{"PlanarPartitions", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"Take", "[", 
              RowBox[{"set", ",", "1"}], "]"}], "~", "Join", "~", 
             "nextPart"}], ",", "allowSingletons"}], "]"}]}], "]"}], "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "set", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"min", "-", "1"}], ",", 
            RowBox[{"Length", "[", "set", "]"}]}], "}"}]}], "]"}]}], ",", 
       "1"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlanarPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "allowSingletons_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlanarPartitions", "[", 
   RowBox[{"set_", ",", "nextPart_", ",", "allowSingletons_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"chunks", ",", "S"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"chunks", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RotateLeft", "[", 
            RowBox[{"set", ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"set", ",", 
                RowBox[{
                "nextPart", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", "S"}], "&"}], "/@", "nextPart"}], 
            ")"}]}], ",", 
          RowBox[{
           RowBox[{"#", "===", "S"}], "&"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"S", ".."}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "chunks", "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", "nextPart", "}"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#", ",", "nextPart"}], "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Outer", "[", 
           RowBox[{"List", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"PlanarPartitions", "[", 
                 RowBox[{"#", ",", "allowSingletons"}], "]"}], "&"}], "/@", 
               "chunks"}], ")"}]}], ",", "1"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "chunks", "]"}], "-", "1"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.642062889371831*^9, 3.642063012579582*^9}, {
  3.642063059149744*^9, 3.642063213378667*^9}, {3.642063249536931*^9, 
  3.64206346830932*^9}, {3.642063510163216*^9, 3.6420635238022947`*^9}, {
  3.642063565968606*^9, 3.642063567785694*^9}, {3.642063635890691*^9, 
  3.642063657563753*^9}, {3.642063903146886*^9, 3.642063961448489*^9}, {
  3.642063998128573*^9, 3.642064042147942*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlanarPartitions", "[", "13", "]"}], "//", "Length"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.6420633440653152`*^9, 3.6420633736647787`*^9}, {
  3.642064046550867*^9, 3.642064087295024*^9}, {3.642064149741705*^9, 
  3.6420641744850903`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10.98700900000000046929926611483097076416`7.061479393547549", ",", 
   "11298"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6420633743988733`*^9, 3.642063434689528*^9, 3.64206347169145*^9, 
   3.642063525640134*^9, 3.642063569454749*^9, 3.642063659909513*^9, {
   3.642063909786724*^9, 3.642063962700225*^9}, {3.642064016019739*^9, 
   3.642064085374832*^9}, {3.6420641470821342`*^9, 3.642064185842122*^9}}]
}, Open  ]]
},
WindowSize->{1011, 775},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4427, 116, 303, "Input"],
Cell[CellGroupData[{
Cell[5010, 140, 310, 7, 28, "Input"],
Cell[5323, 149, 450, 9, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
